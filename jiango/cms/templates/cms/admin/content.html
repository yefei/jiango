{% load admin_pagination %}

<section class="content">
    <div class="row">
        <div style="float:left;width:250px;margin-left:20px;">
            <div class="list-group">
                <a class="list-group-item{% if not path %} active{% endif %}" href="{% url admin:cms:content %}">全部内容
                    <span class="badge">{{ total_content_count }}</span>
                </a>
            </div>
            <div class="list-group">
            {% for p in paths %}
                <a class="list-group-item{% if path == p %} active{% endif %}" href="{% url admin:cms:content-path p.path %}"><span style="margin-left:{{ p.depth }}em">{{ p.name }}</span>
                    <span class="badge">{{ p.content_count }}</span>
                </a>
            {% endfor %}
            </div>
        </div>
        <div style="float:right;width:calc(100% - 310px);margin-right:20px;">
            <form action="{% url admin:cms:content-action %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="back" value="{{request.get_full_path|escape}}">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th class="nowrap"><input type="checkbox" data-spy="checkall" data-for="[name='pk']"></th>
                            <th class="number">ID</th>
                            <th class="nowrap">模型</th>
                            {% if not path %}<th class="nowrap">栏目</th>{% endif %}
                            <th>标题</th>
                            <th class="datetime">修改日期</th>
                            <th class="user">修改人</th>
                            <th class="number">浏览量</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for i in content_set %}
                        <tr>
                            <th class="nowrap"><input type="checkbox" name="pk" value="{{i.pk}}"></th>
                            <td class="number">{{i.pk}}</td>
                            <td class="nowrap">{{ i.model_name }}</td>
                            {% if not path %}<td class="nowrap"><a href="{% url admin:cms:content-path i.path.path %}">{{ i.path.name }}</a></td>{% endif %}
                            <td>
                                {% if i.is_hidden %}<span class="label label-default">隐藏</span>{% endif %}
                                <a href="{% url admin:cms:content-edit i.pk %}">{{i}}</a>
                                <div class="pull-right">
                                    <a href="{{ i.url }}" class="btn btn-xs btn-default" target="_blank">查看</a>
                                </div>
                            </td>
                            <td class="datetime">{{i.update_at}}</td>
                            <td class="user">{{i.update_user}}</td>
                            <td class="number">{{i.views}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="{{ path|yesno:'7,8' }}">
                                <div class="pull-left">
                                    {% for a,i in actions.items %}
                                        <button type="submit" class="btn btn-sm {{i.button_class}}" name="action" value="{{a}}">
                                            {% if i.icon %}<i class="{{i.icon}}"></i> {% endif %}{{i.name}}
                                        </button>
                                    {% endfor %}
                                    {% if can_create_content %}
                                        <i class="sep">|</i>
                                        <a href="{% url admin:cms:content-create current_path.path %}" class="btn btn-sm btn-success"><i class="icon-plus icon-white"></i> 发布内容</a>
                                    {% endif %}
                                </div>
                                <div class="pull-right">
                                    {% paginate content_set %}
                                </div>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </form>
        </div>
    </div>
</section>
